

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; pygpseq 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="pygpseq 0.1.0 documentation" href="../index.html"/>
        <link rel="next" title="How to" href="howto.html"/>
        <link rel="prev" title="Welcome to pygpseq’s documentation!" href="../index.html"/> 

  
  <script src="js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pygpseq
          

          
          </a>

          
            
            
              <div class="version">
                0.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pipeline-steps">Pipeline steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initiation">1. Initiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#segmentation">2. Segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#single-nucleus-analysis">3. Single-nucleus analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-boxplots">4. General boxplots</a></li>
<li class="toctree-l3"><a class="reference internal" href="#final-plots">5. Final plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="#final-report">6. Final report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howto.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">CHANGELOG</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">pygpseq</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/_static/intro.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p><strong>pygpseq</strong> is a Python (<strong>py</strong>) package that provides the tools to analyze microscopy images of <strong>GPSeq</strong> samples. <strong>GPSeq</strong> (Genomic loci Positioning by Sequencing) is a protocol developed in the Bienko lab and, as per title, allows to estimate the radial positioning of genomic loci through sequencing. The imaging step, prior to sequencing, represents an informative step on the quality of the samples and provides additional information for the sequencing data analysis.</p>
<div class="section" id="pipeline-steps">
<h2>Pipeline steps<a class="headerlink" href="#pipeline-steps" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><strong>Initiation</strong>: identify image series and conditions.</li>
<li><strong>Segmentation</strong>: identify nuclei in the images.</li>
<li><strong>Single-nucleus analysis</strong>: retrieve nuclear pixels and calculate profiles.</li>
<li><strong>General boxplots</strong>: study per-pixel and per-nucleus feature distributions.</li>
<li><strong>Final plots</strong>: compare different conditions.</li>
<li><strong>Final report</strong>: produce general pdf report.</li>
</ol>
<div class="section" id="initiation">
<h3>1. Initiation<a class="headerlink" href="#initiation" title="Permalink to this headline">¶</a></h3>
<p>The pipeline starts by looking into the specified <code class="docutils literal"><span class="pre">`basedir`</span></code> (or base directory) for the GPSeq data. The data is expected to be divided in multiple sub-directories, each of which contains images of samples treated with different conditions. Thus, every sub-directory in <cite>basdir</cite> is considered to be a <strong>condition directory</strong>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">basedir</span>
  <span class="o">+</span> <span class="n">condition</span> <span class="c1">#1</span>
    <span class="o">*</span> <span class="n">series1</span><span class="o">.</span><span class="n">channel1</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">*</span> <span class="n">series1</span><span class="o">.</span><span class="n">channel2</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">*</span> <span class="n">series2</span><span class="o">.</span><span class="n">channel1</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">*</span> <span class="n">series2</span><span class="o">.</span><span class="n">channel2</span><span class="o">.</span><span class="n">tif</span>
  <span class="o">+</span> <span class="n">condition</span> <span class="c1">#2</span>
    <span class="o">*</span> <span class="o">...</span>
  <span class="o">+</span> <span class="o">...</span>
</pre></div>
</div>
<p>The extension of the images can be specified in the <code class="docutils literal"><span class="pre">`ext`</span></code> attribute of the class <code class="docutils literal"><span class="pre">`Main`</span></code>, the default is <code class="docutils literal"><span class="pre">`.tif`</span></code>.</p>
<p>The format of the image name can be specified as a regular expression in the <code class="docutils literal"><span class="pre">`reg`</span></code> attribute of the calls <code class="docutils literal"><span class="pre">`Main`</span></code>. The default is reported in the <code class="docutils literal"><span class="pre">`Main`</span></code> class documentation.</p>
<p>In other words, the first step consists in the identification of the condition directories containing properly named tif images, to then proceed with their analysis.</p>
</div>
<div class="section" id="segmentation">
<h3>2. Segmentation<a class="headerlink" href="#segmentation" title="Permalink to this headline">¶</a></h3>
<p>The pipeline continues by going through the series in every condition and identifying the nuclei. Moreover, the median intensity of the background is calculated to be used later during the background removal in the single-nucleus analysis step (3). The segmentation is always performed on the channel containing the DNA staining, and the generated mask is used to estimate the background for the channel containing the linker signal.</p>
<p>The segmentation is performed as follows:</p>
<ul class="simple">
<li>Identify a (stack) global intensity threshold value using the Otsu&#8217;s method. <a class="footnote-reference" href="#id3" id="id1">[1]</a></li>
<li>Binarize the image using the global intensity threshold value.</li>
<li>Binarize the image using an adaptive (local) intensity threshold algorithm that compares the median value of the neighbourhood of every pixel with its intensity. <a class="footnote-reference" href="#id4" id="id2">[2]</a> The size of the side of the square neighbourhood can be specified in the <code class="docutils literal"><span class="pre">`adaptive_neighbourhood`</span></code> attribute of the <code class="docutils literal"><span class="pre">`Main`</span></code> class.</li>
<li>Combine the global and local masks (logical <code class="docutils literal"><span class="pre">`AND`</span></code> operation).</li>
</ul>
<p>Then, the masked objects that touch the image XY borders are removed, and holes are filled both in 3D and on every XY plane (i.e., slice).</p>
<p>Finally, the mask is passed through some filters:</p>
<ul class="simple">
<li>A first filter on the size in the XY plane is applied to remove small objects from the mask.</li>
<li>If performing a 3D analysis, the masked objects are filtered for their size on the Z dimension.</li>
</ul>
<p>Before proceeding with the single nucleus analysis, the objects (i.e., nuclei) in the masked are stored in the <code class="docutils literal"><span class="pre">`Nuclei`</span></code> class. Specifically, the following information are retained:</p>
<ul class="simple">
<li>Series and nucleus id number (1-indexed).</li>
<li>The bounding square (2D) or box (3D).</li>
<li>The pixel/voxel sides ratio.</li>
<li>The background in the original image channels.</li>
<li>The size both in 2D and in 3D (if available).</li>
<li>The surface (only in 3D and if turned on in the <code class="docutils literal"><span class="pre">`Main`</span></code> class).</li>
<li>The sum and mean of the pixel intensities.</li>
<li>The shape of the nucleus (e.g., circularity, sphericity).</li>
<li>The applied global threshold.</li>
</ul>
</div>
<div class="section" id="single-nucleus-analysis">
<h3>3. Single-nucleus analysis<a class="headerlink" href="#single-nucleus-analysis" title="Permalink to this headline">¶</a></h3>
<p>This step of the pipeline iterates over the conditions detected in the beginning. For every condition, the nuclei are selected based on the distribution of user-selected features (based on the FWHM of the highest peak) and the pixels of every selected nucleus are retrieved.</p>
<p>The features that can be selected for the nuclear selection are:</p>
<ul class="simple">
<li>Size: area if 2D and volume if 3D.</li>
<li>Surface: available only for 3D segmentation.</li>
<li>Shape: circularity if 2D, volume if 3D.</li>
<li>Intensity sum: integral of DNA stain intensity.</li>
<li>Intensity mean: average DNA stain intensity.</li>
<li>Flattened size: area in the Z projection.</li>
</ul>
<p>Specifically, the following pixel information are obtained: series and nucleus id number, DNA channel intensity (minus background), signal channel intensity  (minus background), distance from nuclear lamina and relative distance from nuclear lamina.</p>
</div>
<div class="section" id="general-boxplots">
<h3>4. General boxplots<a class="headerlink" href="#general-boxplots" title="Permalink to this headline">¶</a></h3>
<p>General boxplot are generated to recap different distributions for each condition. The following boxplots are generated:</p>
<ul class="simple">
<li>Cell size: area if 2D, volume if 3D.</li>
<li>Cell shape: circularity if 2D, sphericity if 3D.</li>
<li>Cell average DNA stain intensity.</li>
<li>Cell sum (integral) of DNA stain intensity.</li>
<li>Single-pixel DNA stain intensity.</li>
<li>Single-pixel GPSeq signal intensity.</li>
</ul>
</div>
<div class="section" id="final-plots">
<h3>5. Final plots<a class="headerlink" href="#final-plots" title="Permalink to this headline">¶</a></h3>
<p>Then, the following additional plots are generated:</p>
<ul>
<li><dl class="first docutils">
<dt>A <em>pixel study</em> containing the distribution of the single-pixel values is generated for the two channels and their ratio. The study contains 8 plots, from top-to-bottom, left-to-right:</dt>
<dd><ul class="first last simple">
<li>Pixel intensity distribution (boxplot) per binned relative distance from nuclear lamina.</li>
<li>Mean pixel intensity (both raw and smoothened) against relative distance from nuclear lamina.</li>
<li>Median pixel intensity (both raw and smoothened) against relative distance from nuclear lamina.</li>
<li>Mode pixel intensity (both raw and smoothened) against relative distance from nuclear lamina.</li>
<li>Number of pixels per relative distance from nuclear lamina.</li>
<li>Chalk-on-Blackboard plot. Which is a heatmap showing the binned distribution of channel intensity against a binned relative distance from nuclear lamina. Also, the smoothened mean, median and mode curves are reported.</li>
<li>Standard deviation of pixel intensity (both raw and smoothened) against relative distance from nuclear lamina.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>A <em>profiles</em> plot containing six plots, from left-to-right, top-to-bottom:</dt>
<dd><ul class="first last simple">
<li>The DNA staining mean, median and mode smoothened curves.</li>
<li>The DNA staining mean, median and mode smoothened curves first derivative.</li>
<li>The GPSeq signal mean, median and mode smoothened curves.</li>
<li>The GPSeq signal mean, median and mode smoothened curves first derivative.</li>
<li>The channel ratio mean, median and mode smoothened curves.</li>
<li>The channel ratio mean, median and mode smoothened curves first derivative.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="final-report">
<h3>6. Final report<a class="headerlink" href="#final-report" title="Permalink to this headline">¶</a></h3>
<p>A single pdf file report is generated containing the input parameters and most of the generated plots.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Otsu, Nobuyuki. &#8220;A threshold selection method from gray-level histograms.&#8221; Automatica 11.285-296 (1975): 23-27.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.filters.html#skimage.filters.threshold_adaptive">http://scikit-image.org/docs/dev/api/skimage.filters.html#skimage.filters.threshold_adaptive</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="howto.html" class="btn btn-neutral float-right" title="How to" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Welcome to pygpseq’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Gabriele Girelli.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="jquery.js"></script>
      <script type="text/javascript" src="underscore.js"></script>
      <script type="text/javascript" src="doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>